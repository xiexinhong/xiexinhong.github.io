---
title: 重构
date: 2019-09-20 10:00:35
tags:
categories:
- 架构
---

https://www.infoq.cn/article/clean-code-refactor

#重构的作用
1. 改善既有的结构
2. 帮助我们理解原来很难理解的流程
3. 增加对代码和业务逻辑功能的理解

#重构的时机
我们无需专门的挑出时间进行重构，重构应该随时随地的进行，即遵循三次法则：事不过三，三则重构
1. 当添加新功能时如果不是特别容易，可以通过重构使添加特性和新功能变得更容易。
2. 修改 Bug 的时候去重构，比如你在查找定位 Bug 的过程中，发现以前自己的代码或者别人的代码因为设计缺陷比如可扩展性、健壮性比较差造成的，那么此时就是一个比较好的重构时机。
3. Code Review 时去重构，很多公司研发团队都会有定期的 Code Review, 这种活动的好处多多，比如有助于在开发团队中传播知识进行技术分享，有助于让较有经验的开发者把知识传递给欠缺经验的人，并帮助更多的人对软件的其他业务模块更加熟悉从而实现跨模块的迭代开发。

#重构技巧
1. 函数重构
   1. 重命名函数
   2. 移除参数
   3. 将查询函数和修改函数分离
   4. 令函数携带参数
   5. 以明确函数取代参数
   6. 保持对象完整性
   7. 引入参数对象
   8. 移除设值函数
   9. 隐藏函数
   10. 以工厂函数取代构造函数 
2. 条件表达式
	1. 分解条件表达式
	2. 合并条件表达式
	3. 合并重复的条件片段
	4. 移除控制标记
	5. 以卫语句替代嵌套条件表达式
	6. 以多态取代条件表达式
	7. 引入 Null 对象
	8. 引入断言
	9. 以 MAP 取代条件表达式
	10. 通过反射取代条件表达式



#
 
1. 整洁的代码就是一种简约（简单而不过于太简单）的设计，阅读代码的人能很清晰的明白这里在干什么，而不是隐涩难懂，整洁的代码读起来让人感觉到就像阅读散文 - 艺术的沉淀，作者是精心在意缔造出来

2. 们要做的是重构不是重写，要先从小范围的局部重构开始，然后逐步扩展到整个模块。

3. 重复代码（Duplicated Code）首当其冲
	1. 过长函数 (Long Method)、
	2. 过大的类 (Large Class)、
	3. 过长参数列表 (Long Parameter List)、
	4. 冗余类（Lazy Class）、
	5. 冗余函数（Lazy Function）
	6. 无用函数参数（Unused Function Parameter）、
	7. 函数圈复杂度超过 10（The Complexity is over 10）、
	8. 依恋情结（Feature Envy）、
	9. Switch 过多使用（Switch Abuse）、
	10. 过度扩展设计（Over-extend design）、
	11. 不可读或者可读性差的变量名和函数名 (unread variable or function name)、
	12. 异曲同工类（Alternative Classes with Different Interfaces）、
	13. 过度耦合的消息链（Message Chains）、
	14. 令人迷惑的临时字段（Temporary Field）、
	15. 过多注释 (Too Many Comments) 等坏味道。